---


###############################################################################
#
# Groups
#
###############################################################################


name: Variables
is_group: yes
icon: smallFolder
description: >
    Variables are a fundamental part of all MWorks experiments.  They store
    parameters, collect results, and mediate the transfer of data between
    components.


---


name: Actions
is_group: yes
icon: smallFolder
description: >
    Actions are the smallest unit of execution logic within an experiment. They
    initiate a single operation or event (e.g. playing a sound, showing a visual
    stimulus, or assigning a value to a variable).


---


name: Transitions
is_group: yes
icon: smallFolder
description: >
    Transitions control how an experiment moves through a `Task System`. Each
    `Task System State` repeatedly tests its transitions until one of them
    succeeds, after which control passes to the successful transition's target
    state.


---


name: Stimuli
is_group: yes
icon: smallStimulusFolder
description: Visual and auditory stimuli


---


name: Paradigm Components
is_group: yes
icon: smallFolder
description: >
    Paradigm components provide structure to an experiment and determine the
    flow of its execution.  They contain `Actions` and other paradigm
    components.


---


name: Input/Output
is_group: yes
icon: smallIOFolder
description: Input/output (I/O) devices


---


name: Filters
is_group: yes
icon: smallIOFolder
description: Filters and calibrators


---


name: Optimizers and Variable Monitors
is_group: yes
icon: smallFolder
description: >
    Components that watch variable values, automatically perform computations,
    and output results


---


###############################################################################
#
# Placement roots (i.e. top-level allowed parents)
#
###############################################################################


name: IODevices
signature: io_devices
mandatory_tag: IO Devices
icon: smallIOFolder
display_as_group: yes


---


name: Sounds
signature: sounds
mandatory_tag: Sounds
icon: smallFolder
display_as_group: yes


---


name: Stimuli
signature: stimuli
mandatory_tag: Stimuli
icon: smallStimulusFolder
display_as_group: yes


---


name: Variables
signature: variables
mandatory_tag: Variables
icon: smallVariablesFolder
display_as_group: yes


---


name: Calibrators
signature: calibrators
mandatory_tag: Calibrators
icon: smallFolder
display_as_group: yes


---


name: Optimizers
signature: optimizers
mandatory_tag: Optimizers
icon: smallFolder
display_as_group: yes


---


name: Filters
signature: filters
mandatory_tag: Filters
icon: smallFolder
display_as_group: yes


---


name: Experiment
signature: experiment
mandatory_tag: Experiment
icon: smallExperiment
display_as_group: yes


---


###############################################################################
#
# Variables
#
###############################################################################


name: Folder
signature: folder
icon: smallFolder
group: Variables
allowed_parent: 
  - Variables
  - IODevices
  - Filters
  - Optimizers
  - Stimuli
  - Sounds
  - Calibrators
description: >
    A folder for (purely) organizational purposes.  Variables defined in a
    folder will be displayed as an expandable group in MWClient's variables
    window.


---


name: Variable
signature: variable
icon: xyz
inspector: VariableInspectorView
group: Variables
allowed_parent: 
  - Variables
  - Folder
description: >
    A general-purpose variable, used to store experiment parameters, collect
    results, and mediate the transfer of data between components
parameters: 
  - 
    name: default_value
    required: yes
    example: 0
    description: >
        Initial value assigned to the variable when the experiment is loaded
  - 
    name: type
    options: [any, boolean, integer, float, string, list]
    default: any
    deprecated: yes
    description: >
        Controls how the content of `default_value`_ is interpreted.  When set
        to ``any`` (recommended), the default value is parsed like a normal
        expression, and the parser infers its type.
  - 
    name: scope
    options: [global, local]
    default: global
    description: |
        Controls the visibility of changes made to the variable's value.

        If a variable has local scope, then changes to its value are visible
        only within the `paradigm component <Paradigm Components>` in which the
        assignment was made.  These local changes persist between executions of
        the paradigm component.

        If a variable has global scope, changes to its value are visible
        everywhere.
  - 
    name: logging
    options: [never, when_changed]
    default: when_changed
    description: >
        Determines when the variable's value is written to the event stream (and
        thereby the data file)
  -
    name: persistant
    default: 'NO'
    description: >
        If ``YES``, then the variable's value is included in saved variable sets
        created via MWClient
  - 
    name: exclude_from_data_file
    default: 'NO'
    description: >
        If ``YES``, then the variable's value is *not* written to the data file.
        Other event stream listeners (e.g. MWClient, client- and server-side
        conduits) continue to receive its value.
  -
    name: groups
    description: >
        Comma-separated list containing the names of groups to which the
        variable belongs.  Variable groups are displayed as expandable sections
        in MWClient's variables window.


---


name: Selectable
abstract: yes
parameters: 
  - 
    name: selection
    options:
      - sequential
      - sequential_ascending
      - sequential_descending
      - random_without_replacement
      - random_with_replacement
    default: sequential
    description: Order in which to draw selections
  - 
    name: nsamples
    default: 1
    description: >
       Number of samples to allow before `Reset Selections` is required
  - 
    name: sampling_method
    options: [cycles, samples]
    default: cycles
    description: >
        Controls the interpretation of `nsamples`_.  If set to ``cycles``, *all*
        possible selections must be made to complete one sample.  If set to
        ``samples``, each individual selection counts as a sample.


---


name: Selection Variable
signature: variable/selection
isa: Selectable
icon: xyz
group: Variables
allowed_parent: 
  - Variables
  - Folder
description: >
    A variable whose current value is drawn from a list of possible values.  The
    order and number of selected values are determined by `selection`_,
    `nsamples`_, and `sampling_method`_.  Use `Next Selection` to advance to the
    next value.
parameters: 
  - 
    name: values
    required: yes
    description: >
        Comma-separated list of values from which the variable's current value
        is drawn
  - 
    name: advance_on_accept
    default: 'NO'
    description: >
        If ``YES``, `Accept Selections` will automatically invoke
        `Next Selection` (unless all selections have been exhausted)
  - 
    name: autoreset
    default: 'NO'
    description: >
        If ``YES``, `Reset Selections` will be invoked automatically when all
        selections have been exhausted
  -
    name: groups
    description: >
        Comma-separated list containing the names of groups to which the
        variable belongs.  Variable groups are displayed as expandable sections
        in MWClient's variables window.


---


###############################################################################
#
# Stimuli
#
###############################################################################


name: Stimulus
abstract: yes
icon: smallStimulus
group: Stimuli
allowed_parent: 
  - Range Replicator
  - List Replicator
  - Stimuli
  - Stimulus Group
  - Folder
parameters:
  - 
    name: deferred
    options: ['no', 'yes', 'explicit']
    default: 'no'
    description: >
        Controls when the stimulus is loaded.  If ``no``, the stimulus is loaded
        at experiment load time.  If ``yes``, the stimulus is loaded the first
        time it is `queued <Queue Stimulus>`.  If ``explicit``, the stimulus
        must be loaded explictly with `Load Stimulus`.


---


name: Stimulus Group
signature: stimulus_group
icon: smallStimulusFolder
group: Stimuli
allowed_parent: 
  - Range Replicator
  - List Replicator
  - Stimuli
  - Stimulus Group
  - Folder
description: An indexable group of stimuli


---


name: Basic Transform Stimulus
abstract: yes
isa: Stimulus
parameters: 
  - 
    name: x_size
    required: yes
    example: 5.0
    description: Horizontal size in degrees
  - 
    name: y_size
    required: yes
    example: 5.0
    description: Vertical size in degrees
  - 
    name: x_position
    default: 0.0
    description: Horizontal center position in degrees
  - 
    name: y_position
    default: 0.0
    description: Vertical center position in degrees
  - 
    name: rotation
    default: 0.0
    description: Rotation in degrees
  - 
    name: alpha_multiplier
    default: 1.0
    description: >
        Controls the transparency of the stimulus.  ``1.0`` is fully opaque,
        while ``0.0`` is fully tranparent.


---


name: Image Stimulus
signature: stimulus/image_file
isa: Basic Transform Stimulus
inspector: ImageStimulusInspectorView
description: |
    An image stimulus loaded from any standard-format image file.

    *Note*:  To preserve the image's aspect ratio on screen, `x_size`_ and
    `y_size`_ must be equal.  When drawn, the larger dimension spans the full
    specified size, while the smaller dimension is scaled to maintain the
    aspect ratio.
parameters: 
  - 
    name: path
    required: yes
    example:
      - images/image1.png
      - /path/to/image.png
    description: Filesystem path to the image file


---


name: Blank Fullscreen Stimulus
signature: stimulus/blank_screen
isa: Stimulus
description: >
    A stimulus that fills the screen with a user-defined color.  This
    stimulus must be `queued <Queue Stimulus>` like any other.
parameters: 
  - 
    name: color
    default: 0.5,0.5,0.5
    description: >
        The fill color, expressed as a comma-separated list of red, green, and
        blue components with values between 0 and 1 (inclusive).  The list can
        include variable names in place of explicit values, in which case the
        corresponding component value will be read from the named variable.


---


name: Colored Transform Stimulus
abstract: yes
isa: Basic Transform Stimulus
parameters: 
  - 
    name: color
    default: 1.0,1.0,1.0
    description: >
        The color of the stimulus, expressed as a comma-separated list of red,
        green, and blue components with values between 0 and 1 (inclusive).  The
        list can include variable names in place of explicit values, in which
        case the corresponding component value will be read from the named
        variable.


---


name: Rectangle Stimulus
signature: stimulus/rectangle
isa: Colored Transform Stimulus
description: A rectangle stimulus


---


name: Ellipse Stimulus
signature: stimulus/circle
isa: Colored Transform Stimulus
description: An ellipse stimulus


---


name: Fixation Point Stimulus
signature: stimulus/fixation_point
isa: Rectangle Stimulus
description: A rectangluar fixation point stimulus
parameters: 
  - 
    name: trigger_width
    required: yes
    description: >
        Width of the (square) fixation window, which shares its center with
        the visible stimulus rectangle
  - 
    name: trigger_watch_x
    required: yes
    description: >
        Variable containing the horizontal eye position
  - 
    name: trigger_watch_y
    required: yes
    description: >
        Variable containing the vertical eye position
  - 
    name: trigger_flag
    required: yes
    description: >
        Variable to which fixation status is written. When the
        subject's gaze (as reported by `trigger_watch_x`_ and
        `trigger_watch_y`_) enters the fixation window, the variable is set to
        true.  When the subject's gaze leaves the fixation window, the variable
        is set to false.


---


name: Circular Fixation Point Stimulus
signature: stimulus/circular_fixation_point
isa: Ellipse Stimulus
description: An elliptical fixation point stimulus
parameters: 
  - 
    name: trigger_width
    required: yes
    description: >
        Width of the (circular) fixation window, which shares its center with
        the visible stimulus ellipse
  - 
    name: trigger_watch_x
    required: yes
    description: >
        Variable containing the horizontal eye position
  - 
    name: trigger_watch_y
    required: yes
    description: >
        Variable containing the vertical eye position
  - 
    name: trigger_flag
    required: yes
    description: >
        Variable to which fixation status is written. When the
        subject's gaze (as reported by `trigger_watch_x`_ and
        `trigger_watch_y`_) enters the fixation window, the variable is set to
        true.  When the subject's gaze leaves the fixation window, the variable
        is set to false.


---


name: Sound Stimulus
signature: sound/wav_file
inspector: SoundStimulusInspectorView
group: Stimuli
allowed_parent: 
  - Sounds
  - Folder
description: >
    A simple `WAV <https://en.wikipedia.org/wiki/WAV>`_ file based sound
    stimulus
parameters: 
  - 
    name: path
    required: yes
    example:
      - sounds/sound1.wav
      - /path/to/sound.wav
    description: Filesystem path to the sound file
  - 
    name: amplitude
    default: 1.0
    description: >
        Controls the volume at which the sound plays.  ``1.0`` is full volume,
        while ``0.0`` is silent.


---


###############################################################################
#
# Paradigm components
#
###############################################################################


name: Paradigm Component
abstract: yes
group: Paradigm Components
allowed_parent: 
  - Range Replicator
  - List Replicator


---


name: Range Replicator
signature: range_replicator
icon: replicatorIcon
inspector: RangeReplicatorInspectorView
group: Paradigm Components
allowed_parent: 
  - Experiment
  - Protocol
  - Block
  - Trial
  - List
  - Range Replicator
  - List Replicator
  - Stimuli
  - Stimulus Group
  - Sounds
  - Variables
description: >
    A construct that replicates its contents (textually) at parse time.  Each
    replication assigns a different, sequential value to the specified
    `variable`_ (similar to a `for loop
    <https://en.wikipedia.org/wiki/For_loop>`_). This can be used, for example,
    to generate a separate `Trial` for each element in a `Stimulus Group` by
    using the replicator variable as the index in to the group.
parameters: 
  - 
    name: variable
    required: yes
    description: >
        Replicator variable.  The variable must have local scope.
  - 
    name: from
    required: yes
    description: >
        First value assigned to `variable`_
  - 
    name: to
    required: yes
    description: >
        Replication stops when `variable`_ is greater than this value
  - 
    name: step
    required: yes
    description: >
        Amount by which to increment the value of `variable`_ after each
        replication.  Must be greater than zero.


---


name: List Replicator
signature: list_replicator
icon: replicatorIcon
group: Paradigm Components
allowed_parent: 
  - Experiment
  - Protocol
  - Block
  - Trial
  - List
  - Range Replicator
  - List Replicator
  - Stimuli
  - Stimulus Group
  - Sounds
  - Variables
description: >
    A construct that replicates its contents (textually) at parse time.  Each
    replication assigns a different value from a user-provided list to the
    specified `variable`_ (similar to a `foreach loop
    <https://en.wikipedia.org/wiki/Foreach_loop>`_). This can be used, for
    example, to generate a `Stimulus Group` of `images <Image Stimulus>` by
    using the replicator variable as the path to each image file.
parameters: 
  - 
    name: variable
    required: yes
    description: >
        Replicator variable.  The variable must have local scope.
  - 
    name: values
    required: yes
    description: >
        Comma-separated list of values to assign to `variable`_, one per
        replication


---


name: Container State
abstract: yes
isa: Paradigm Component
parameters: 
  - 
    name: interruptible
    default: 'YES'
    description: >
        If ``NO``, then any request to pause or stop the experiment while this
        component is executing will be deferred until said execution completes.
        This behavior is inherited by the component's children, making them
        non-interruptible as well.


---


name: List State
abstract: yes
isa: [Container State, Selectable]
inspector: ListStateInspectorView


---


name: Protocol
signature: protocol
isa: List State
icon: smallProtocol
allowed_parent: Experiment
description: |
    A top-level paradigm component that contains other sub-components.

    Protocols are the largest unit of logical organization in an experiment.  To
    "run" an experiment really means to run one or more of its protocols.

    The execution order and number of repetitions of a protocol's sub-components
    are determined by `selection`_, `nsamples`_, and `sampling_method`_.


---


name: Block
signature: block
isa: List State
icon: smallBlock
allowed_parent: Protocol
description: |
    A container paradigm component.

    The execution order and number of repetitions of a block's sub-components
    are determined by `selection`_, `nsamples`_, and `sampling_method`_.


---


name: Trial
signature: trial
isa: List State
icon: smallTrial
allowed_parent: 
  - Protocol
  - Block
  - Trial
  - List
description: |
    A container paradigm component.

    The execution order and number of repetitions of a trial's sub-components
    are determined by `selection`_, `nsamples`_, and `sampling_method`_.


---


name: List
signature: list
isa: List State
icon: smallList
allowed_parent: 
  - Protocol
  - Block
  - Trial
  - List
description: |
    A container paradigm component.

    The execution order and number of repetitions of a list's sub-components are
    determined by `selection`_, `nsamples`_, and `sampling_method`_.


---


name: Task System
signature: task_system
isa: Container State
icon: smallTaskSystem
allowed_parent: 
  - Protocol
  - Block
  - List
  - Trial
description: >
    A paradigm component defining a `finite state machine
    <https://en.wikipedia.org/wiki/Finite-state_machine>`_.  It contains `Task
    System State` objects, which execute `Actions` and select `Transitions`
    from one state to the next. The task system finishes when one of its states
    evaluates an `Exit Task System` transition.


---


name: Task System State
signature: task_system_state
isa: Container State
icon: smallTaskSystemState
allowed_parent: Task System
description: >
    A paradigm component defining a state within a `finite state machine
    <https://en.wikipedia.org/wiki/Finite-state_machine>`_. It is contained
    within a `Task System` and specifies a list of `Actions`, which are executed
    when the state first gains control, and a list of `Transitions`, which are
    evaluated repeatedly until one of them succeeds and selects the next state.


---


###############################################################################
#
# Actions
#
###############################################################################


name: Action
abstract: yes
icon: actionIcon
group: Actions
allowed_parent: 
  - Task System State
  - Variable
  - Trial
  - Block
  - List
  - Protocol
  - Conditionally Execute Actions
  - Schedule Actions
  - Folder
disallowed_sibling_before: 
  - Transition
  - Variable
  - TransitionMarker
disallowed_sibling_after: ActionMarker


---


name: ActionMarker
signature: action_marker
unmoveable: yes
allowed_parent: Task System State
disallowed_sibling_before: TransitionMarker


---


name: Report / Message
signature: action/report
isa: Action
icon: reportAction
inspector: ReportInspectorView
description: Write a message to the console and event stream
parameters: 
  - 
    name: message
    required: yes
    description: >
        Message text.  You can include variable values in the message by
        placing a ``$`` before each variable's name (e.g. ``x = $x, y = $y``)


---


name: Assign Variable
signature: action/assignment
isa: Action
icon: actionIcon
inspector: AssignmentInspectorView
description: Assign a value to a variable
parameters: 
  - 
    name: variable
    required: yes
    description: Variable name
  - 
    name: value
    required: yes
    description: Value to assign


---


name: Pulse Variable
signature: action/pulse
isa: Action
inspector: PulseInspectorView
description: >
    Sets a variable high (i.e. sets its value to 1).  Then, after the specified
    duration, sets it low (i.e. to 0).  The end of the pulse is triggered
    asynchronously, so this action does *not* pause the experiment.
parameters: 
  - 
    name: variable
    required: yes
    description: Variable to pulse
  - 
    name: duration
    required: yes
    description: Duration of the pulse (microseconds)


---


name: Assert
signature: action/assert
isa: Action
description: >
    Tests a boolean condition.  If the condition evaluates to false, reports an
    error with the specified message.
parameters: 
  - 
    name: condition
    required: yes
    description: Condition expression
  - 
    name: message
    description: >
       Error message to report if the assertion fails.  If omitted, a default
       message containing the condition expression is used.
  - 
    name: stop_on_failure
    default: 'NO'
    description: >
        If ``YES``, the experiment will automatically stop if the assertion
        fails


---


name: Schedule Actions
signature: action/schedule
isa: Action
inspector: ScheduleInspectorView
description: >
    Schedule the execution of a list of contained actions.  These actions can be
    scheduled to occur after a user-defined delay and can be repeated multiple
    times with a user-defined inter-execution interval.
parameters: 
  - 
    name: delay
    required: yes
    description: Initial delay before first execution (microseconds)
  - 
    name: duration
    required: yes
    description: Delay before each execution after the first (microseconds)
  - 
    name: repeats
    required: yes
    description: >
        Number of times to repeat execution.  The special value ``-999`` causes
        execution to repeat indefinitely (until the experiment stops or
        `cancel`_ is set to true).
  - 
    name: cancel
    description: >
        If set to the name of a variable, assigning a true value (e.g. ``true``,
        ``YES``, ``1``) to that variable will cancel all future executions of
        the contained actions


---


name: Conditionally Execute Actions
signature: action/if
isa: Action
inspector: IfInspectorView
allowed_parent: Conditional Branching (If/Else)
description: Execute a list of actions if a condition is true
parameters: 
  - 
    name: condition
    required: yes
    description: Condition expression


---


name: Conditional Branching (If/Else)
signature: action/if_else
isa: Action
description: >
    Given a list of `Conditionally Execute Actions` ("if") actions, executes the
    first one whose condition is true, or none if all conditions are false.  To
    implement an unconditional "else" action, add a conditional with an
    always-true condition at the end of the list.


---


name: Timer Action
abstract: yes
isa: Action
icon: startTimer
parameters: 
  - 
    name: duration
    required: yes
    example: 1.0
    description: Duration
  - 
    name: duration_units
    options: [us, ms, s]
    default: us
    description: Duration units
  - 
    name: timebase
    description: >
        If set to the name of a `timebase <Set Timebase>`, the expiration time
        will be measured relative to that timebase.  If omitted, the current
        time will be used as the timebase.


---


name: Wait
signature: action/wait
isa: Timer Action
inspector: WaitInspectorView
description: |
    Pause for a specified amount of time.

    *Note*: This action is not intended for precise coordination of timed
    events. For a greater degree of temporal control, use a `Task System` with a
    timer object and a `Timer Expired Transition`.


---


name: Wait for Condition
signature: action/wait_for_condition
isa: Action
icon: startTimer
description: >
    Wait until a condition becomes true or a timeout occurs.  If the wait
    times out before the condition becomes true, issue an error message and
    (optionally) stop the experiment.
parameters: 
  - 
    name: condition
    required: yes
    description: Condition expression
  - 
    name: timeout
    required: yes
    description: Timeout duration (microseconds)
  - 
    name: timeout_message
    description: >
       Error message to report if the wait times out.  If omitted, a default
       message is used.
  - 
    name: stop_on_timeout
    default: 'YES'
    description: If true, stop the experiment if the wait times out


---


name: Start Timer
signature: action/start_timer
isa: Timer Action
inspector: StartTimerInspectorView
description: >
    Starts a named timer that can be used to control the flow through a `Task
    System`.  The `Timer Expired Transition` and the ``timerExpired`` function
    can be used to evaluate whether the timer has expired.
parameters: 
  - 
    name: timer
    required: yes
    example: MyTimer
    description: Name for the timer


---


name: Set Timebase
signature: action/set_timebase
isa: Action
icon: startTimer
inspector: SetTimebaseInspectorView
description: >
    Sets a named reference time against which `timers <Start Timer>` can be
    defined
parameters: 
  - 
    name: timebase
    required: yes
    example: MyTimebase
    description: Name for the timebase


---


name: Load Stimulus
signature: action/load_stimulus
isa: Action
inspector: LoadStimulusInspectorView
description: >
    Explicitly load a stimulus object (e.g. load a file from disk, compute a
    dynamically generated stimulus, etc.).  This is useful when the ``deferred``
    parameter on the stimulus is set to ``yes`` or ``explicit``.
parameters: 
  - 
    name: stimulus
    required: yes
    description: Stimulus to load


---


name: Unload Stimulus
signature: action/unload_stimulus
isa: Action
description: >
    Explicitly unload a stimulus object, thereby releasing any memory or other
    resources used by the stimulus.  This is useful when the ``deferred``
    parameter on the stimulus is set to ``yes`` or ``explicit``.
parameters: 
  - 
    name: stimulus
    required: yes
    description: Stimulus to unload


---


name: Queue Stimulus
signature: action/queue_stimulus
alias: action/show_stimulus
isa: Action
inspector: QueueStimulusInspectorView
description: >
    Place a stimulus into the display queue, ready to be displayed when
    the next `Update Stimulus Display` action is issued
parameters: 
  - 
    name: stimulus
    required: yes
    description: Stimulus to queue


---


name: Live Queue Stimulus
signature: action/live_queue_stimulus
isa: Action
inspector: QueueStimulusInspectorView
description: >
    Place a stimulus into the display queue, ready to be displayed when the next
    `Update Stimulus Display` action is issued.  Differs from `Queue Stimulus`
    in that values for variables controlling the appearance of the stimulus will
    remain malleable right up until the moment that the display is updated.
parameters: 
  - 
    name: stimulus
    required: yes
    description: Stimulus to queue


---


name: Dequeue Stimulus
signature: action/dequeue_stimulus
alias: action/hide_stimulus
isa: Action
inspector: DequeueStimulusInspectorView
description: >
    Remove a stimulus from the display queue, so that it will no longer be
    displayed after the next `Update Stimulus Display` action is issued
parameters: 
  - 
    name: stimulus
    required: yes
    description: Stimulus to dequeue


---


name: Bring Stimulus to Front
signature: action/bring_stimulus_to_front
isa: Action
description: Move a stimulus to the top of the display queue
parameters: 
  - 
    name: stimulus
    required: yes
    description: Stimulus to move


---


name: Send Stimulus to Back
signature: action/send_stimulus_to_back
isa: Action
description: Move a stimulus to the bottom of the display queue
parameters: 
  - 
    name: stimulus
    required: yes
    description: Stimulus to move


---


name: Update Stimulus Display
signature: action/update_stimulus_display
isa: Action
inspector: UpdateDisplayInspectorView
description: |
    Commit pending changes to the display queue, and trigger a redraw of the
    stimulus display.  On the next display refresh, any stimuli that have been
    `queued <Queue Stimulus>` will be drawn, and any stimuli that have been
    `dequeued <Dequeue Stimulus>` will *not* be drawn (and thus will be erased
    if they were previously visible).

    *Note*: Before completing, this action waits for all stimulus drawing
    commands to be submitted to the graphics hardware.  However, it does *not*
    wait for the actual display update to occur.  If your experiment must
    coordinate other actions with the actual display update, it will need
    to wait until the time provided by `predicted_output_time`_.

parameters: 
  - 
    name: predicted_output_time
    description: >
        Name of a variable in which to store the predicted output time of the
        frame in which the update will take effect.  This time is the operating
        system's best guess for when the rendered frame will start to appear on
        screen.


---


name: Play Sound
signature: action/play_sound
isa: Action
inspector: PlaySoundInspectorView
description: Play a `Sound Stimulus`
parameters: 
  - 
    name: sound
    required: yes
    description: Name of the sound to play


---


name: Pause Sound
signature: action/pause_sound
isa: Action
description: Pause a `Sound Stimulus`
parameters: 
  - 
    name: sound
    required: yes
    description: Name of the sound to pause


---


name: Stop Sound
signature: action/stop_sound
isa: Action
inspector: StopSoundInspectorView
description: Stop playing a `Sound Stimulus`
parameters: 
  - 
    name: sound
    required: yes
    description: Name of the sound to stop


---


name: Accept Selections
signature: action/accept_selections
isa: Action
inspector: AcceptSelectionsInspectorView
description: >
    Permanently accept the selections that have been made so far on a selectable
    object.  Once accepted, these selections cannot be undone with a `Reject
    Selections` action.
parameters: 
  - 
    name: selection
    required: yes
    description: Name of the selectable object


---


name: Reject Selections
signature: action/reject_selections
isa: Action
inspector: RejectSelectionsInspectorView
description: >
    Reject all non-accepted selections on a selectable object (i.e. those made
    since the last `Accept Selections` action).  From the point of view of the
    selectable object, it will be as if these selections were never made.
parameters: 
  - 
    name: selection
    required: yes
    description: Name of the selectable object


---


name: Reset Selections
signature: action/reset_selection
isa: Action
inspector: ResetSelectionInspectorView
description: >
    Reset all selections on a selectable object, including any that were
    previously accepted.  From the point of view of the selectable object, it
    will be as if no selections were never made.
parameters: 
  - 
    name: selection
    required: yes
    description: Name of the selectable object


---


name: Next Selection
signature: action/next_selection
isa: Action
inspector: NextSelectionInspectorView
description: >
    Advance to the next selection on a `Selection Variable`.  This action
    does not work on other selectable objects (such as `Block` or `Trial`).
parameters: 
  - 
    name: selection
    required: yes
    description: Name of the selection variable


---


name: Pause Experiment
signature: action/pause_experiment
isa: Action
description: >
    Pause the experiment


---


name: Resume Experiment
signature: action/resume_experiment
isa: Action
description: >
    Resume a paused experiment


---


name: Stop Experiment
signature: action/stop_experiment
isa: Action
description: >
    Stop the experiment.  Gives an experiment the ability to terminate
    itself (e.g. in response to a fatal error).


---


name: Start IO Device
signature: action/start_device_io
isa: Action
inspector: StartIOInspectorView
description: >
    Enable an `I/O device <Input/Output>`.  Most I/O devices will not perform
    input/output tasks until explicitly started.
parameters: 
  - 
    name: device
    required: yes
    description: Name of the I/O device to enable


---


name: Stop IO Device
signature: action/stop_device_io
isa: Action
inspector: StopIOInspectorView
description: >
    Disable an `I/O device <Input/Output>`.  Most I/O devices will stop
    performing input/output tasks when stopped.
parameters: 
  - 
    name: device
    required: yes
    description: Name of the I/O device to disable


---


name: Take Calibration Sample
signature: action/take_calibration_sample
isa: Action
description: >
    Instruct a calibrator object to take a new calibration sample.  The
    calibrator object takes both measured values and the corresponding "true"
    values (provided by a "calibratable" object) and uses them to determine a
    mapping function.
parameters: 
  - 
    name: calibrator
    required: yes
    description: Name of the calibrator
  - 
    name: calibratable_object
    required: yes
    description: Name of the calibratable object


---


name: Update Calibration
signature: action/update_calibration
isa: Action
description: >
    Prompt a calibrator object to compute a new calibration mapping
    function based on samples taken using the `Take Calibration Sample`
    action
parameters: 
  - 
    name: calibrator
    required: yes
    description: Name of the calibrator


---


name: Clear Calibration
signature: action/clear_calibration
isa: Action
description: >
    Prompt a calibrator object to "forget" all previously collected
    calibration samples
parameters: 
  - 
    name: calibrator
    required: yes
    description: Name of the calibrator


---


name: Begin Averaged Calibration Sample
signature: action/begin_calibration_average
isa: Action
description: >
    Instruct a calibrator object to start computing an average of its input
    value(s)
parameters: 
  - 
    name: calibrator
    required: yes
    description: Name of the calibrator


---


name: End Averaged Calibration and Ignore
signature: action/end_calibration_average_and_ignore
isa: Action
description: >
    Instruct a calibrator object to stop computing an average of its input
    value(s) and discard the accumulated data
parameters: 
  - 
    name: calibrator
    required: yes
    description: Name of the calibrator


---


name: End Averaged Calibration Sample
signature: action/end_calibration_average_and_take_sample
isa: Action
description: >
    Instruct a calibrator object to stop computing an average of its input
    value(s) and take a new calibration sample from the accumulated average,
    with the specified "calibratable" object providing the corresponding "true"
    value
parameters: 
  - 
    name: calibrator
    required: yes
    description: Name of the calibrator
  - 
    name: calibratable_object
    required: yes
    description: Name of the calibratable object


---


name: Play Dynamic Stimulus
signature: action/play_dynamic_stimulus
isa: Action
description: Start playing a dynamic stimulus
parameters: 
  - 
    name: stimulus
    required: yes
    description: Name of the dynamic stimulus


---


name: Stop Dynamic Stimulus
signature: action/stop_dynamic_stimulus
isa: Action
description: Stop a dynamic stimulus
parameters: 
  - 
    name: stimulus
    required: yes
    description: Name of the dynamic stimulus


---


name: Pause Dynamic Stimulus
signature: action/pause_dynamic_stimulus
isa: Action
description: Pause a playing dynamic stimulus
parameters: 
  - 
    name: stimulus
    required: yes
    description: Name of the dynamic stimulus


---


name: Unpause Dynamic Stimulus
signature: action/unpause_dynamic_stimulus
isa: Action
description: Unpause (i.e. resume playing) a paused dynamic stimulus
parameters: 
  - 
    name: stimulus
    required: yes
    description: Name of the dynamic stimulus


---


###############################################################################
#
# Transitions
#
###############################################################################


name: Transition
abstract: yes
icon: transitionIcon
group: Transitions
allowed_parent: Task System State
disallowed_sibling_after: 
  - Action
  - ActionMarker
  - TransitionMarker


---


name: TransitionMarker
signature: transition_marker
unmoveable: yes
allowed_parent: Task System State
disallowed_sibling_after: ActionMarker


---


name: Always Go Transition
signature: transition/direct
isa: Transition
icon: alwaysGo
inspector: AlwaysGoTransitionInspectorView
description: A transition that always goes to the specified target state
parameters: 
  - 
    name: target
    required: yes
    description: Name of the target state


---


name: Conditional Transition
signature: transition/conditional
isa: Transition
icon: conditionalTransition
inspector: ConditionalTransitionInspectorView
description: >
    A transition that goes to the target state if a specified condition
    expression is true
parameters: 
  - 
    name: condition
    required: yes
    description: Condition expression
  - 
    name: target
    required: yes
    description: Name of the target state


---


name: Timer Expired Transition
signature: transition/timer_expired
isa: Transition
icon: timerTransition
inspector: TimerExpiredTransitionInspectorView
description: >
    A transition that goes to the target state if a specified timer has expired
parameters: 
  - 
    name: timer
    required: yes
    description: Name of the timer
  - 
    name: target
    required: yes
    description: Name of the target state


---


name: Exit Task System
signature: transition/yield
isa: Transition
icon: yieldToParent
inspector: ExitTaskSystemTransitionInspectorView
description: >
    A transition that yields control back to the parent of the current
    `Task System`


---


###############################################################################
#
# Input/output
#
###############################################################################


name: IODevice
abstract: yes
icon: smallIOFolder
group: Input/Output
allowed_parent: 
  - IODevices
  - Folder


---


name: IOChannel
abstract: yes
icon: smallIOFolder
group: Input/Output
allowed_parent: Folder


---


name: Stimulus Display
signature: iodevice/stimulus_display
isa: IODevice
description: >
    A stimulus display device.  At present, MWorks always creates one (and
    only one) of these per experiment, regardless of whether the experiment
    file defines one.  By including a definition in your experiment file,
    you can change the display's default background color.
parameters: 
  - 
    name: background_color
    required: yes
    example: 0.5,0.5,0.5
    description: >
        The background color, expressed as a comma-separated list of red, green,
        and blue components with values between 0 and 1 (inclusive)
  - 
    name: announce_stimuli_on_implicit_updates
    default: 'YES'
    description: >
        Controls the announcement of stimuli during "implicit" display updates
        (i.e. updates requested by running dynamic stimuli and *not* triggered
        by an explicit `Update Stimulus Display` action).  If set to ``NO``,
        then implicit updates will not generate ``#announceStimulus`` events,
        and ``#stimDisplayUpdate`` events for implicit updates will contain only
        the number of stimuli displayed (in place of the usual list of stimulus
        parameters).


---


###############################################################################
#
# Filters
#
###############################################################################


name: Calibrator
abstract: yes
icon: fakeMonkey
group: Filters
allowed_parent: 
  - Filters
  - IODevices
  - Folder


---


name: Base Eye Calibrator
abstract: yes
isa: Calibrator
parameters: 
  - 
    name: eyeh_raw
    required: yes
    description: >
        Variable from which to read the raw (input) horizontal eye
        position
  - 
    name: eyev_raw
    required: yes
    description: >
        Variable from which to read the raw (input) vertical eye
        position
  - 
    name: eyeh_calibrated
    required: yes
    description: >
        Variable in which to store the calibrated (output)
        horizontal eye position
  - 
    name: eyev_calibrated
    required: yes
    description: >
        Variable in which to store the calibrated (output)
        vertical eye position


---


name: Eye Calibrator
signature: calibrator/standard_eye_calibrator
isa: Base Eye Calibrator
description: >
    An I/O calibrator specially tailored for eye movement signals.  Uses a
    second-order (quadratic) fit function.


---


name: Linear Eye Calibrator
signature: calibrator/linear_eye_calibrator
isa: Base Eye Calibrator
description: >
    An I/O calibrator specially tailored for eye movement signals.  Uses a
    first-order (linear) fit function.


---


name: Filter
abstract: yes
icon: fakeMonkey
group: Filters
allowed_parent: 
  - Filters
  - IODevices
  - Folder


---


name: Box-car Filter
signature: filter/boxcar_filter_1d
isa: Filter
description: A basic 1-D boxcar (moving average) filter
parameters: 
  - 
    name: in1
    required: yes
    description: Variable from which to read input values
  - 
    name: out1
    required: yes
    description: Variable in which to store output values
  - 
    name: width_samples
    required: yes
    description: >
        Number of samples to store in memory and average over


---


name: Eye Monitor
signature: filter/basic_eye_monitor
isa: Filter
description: >
    A filter that takes in an eye signal and outputs basic parameters, such
    as velocity, saccade state, etc.
parameters: 
  - 
    name: eyeh_calibrated
    required: yes
    description: >
        Variable from which to read horizontal eye position
  - 
    name: eyev_calibrated
    required: yes
    description: >
        Variable from which to read vertical eye position
  - 
    name: eye_state
    required: yes
    description: >
        Variable in which to store computed eye state (0 for
        fixation, 1 for saccade)
  - 
    name: eye_velocity_h
    description: >
        Variable in which to store computed horizontal eye velocity
        (units per second)
  - 
    name: eye_velocity_v
    description: >
        Variable in which to store computed vertical eye velocity
        (units per second)
  - 
    name: width_samples
    required: yes
    description: >
        Number of samples to store in internal `boxcar filters <Box-car Filter>`
        that are applied to computed velocity components
  - 
    name: saccade_entry_speed
    required: yes
    description: > 
        A computed eye speed greater than this speed denotes a saccade
        (units per second)
  - 
    name: saccade_exit_speed
    required: yes
    description: > 
        A computed eye speed less than or equal to this speed indicates
        fixation (units per second)


---


###############################################################################
#
# Optimizers and variable monitors
#
###############################################################################


name: Optimizer
abstract: yes
icon: smallFolder
group: Optimizers and Variable Monitors
allowed_parent: Optimizers


---


name: Simple Staircase Optimizer
signature: staircase
isa: Optimizer
icon: fakeMonkey
inspector: StaircaseInspectorView
description: >
    An object that watches a variable (e.g. a flag reporting success in a
    behavioral task) and moves another variable up and down according to
    some criteria
parameters: 
  - 
    name: watch
    required: yes
    description: Variable to watch
  - 
    name: output
    required: yes
    description: Variable to vary
  - 
    name: lower_limit
    required: yes
    description: Lower bound for output
  - 
    name: upper_limit
    required: yes
    description: Upper bound for output
  - 
    name: up_criterion
    required: yes
    description: >
        If watched variable value is greater than or equal to this value,
        output steps up
  - 
    name: down_criterion
    required: yes
    description: >
        If watched variable value is less than or equal to this value,
        output steps down
  - 
    name: step_size
    required: yes
    description: Step size for changing output
  - 
    name: grace_period
    required: yes
    description: >
        Don't step anywhere unless watched variable has been updated at least
        this many times
  - 
    name: history
    required: yes
    description: >
        Number of samples to store in internal `boxcar filter <Box-car Filter>`
        used to average watched variable values


---


name: Bias Monitor
signature: bias_monitor
isa: Optimizer
icon: fakeMonkey
inspector: BiasMonitorInspectorView
description: >
    An object that watches parameters of a behavioral task and assesses the
    probability that the subject is adopting some form of biased strategy
parameters: 
  - 
    name: success
    required: yes
    description: >
        Variable that indicates task success/failure (via a value
        of 1 or 0, respectively)
  - 
    name: response_index
    required: yes
    description: >
        Variable that indicates e.g. physical response location
        (relevant value is when success changes)
  - 
    name: task_correlation
    required: yes
    description: >
        Variable in which to store extent to which responses are
        consistent with the task
  - 
    name: response_bias_correlation
    required: yes
    description: >
        Variable in which to store extent to which responses are
        consistent with a response bias
  - 
    name: alternation_correlation
    required: yes
    description: >
        Variable in which to store extent to which responses are
        consistent with alternation
  - 
    name: history
    required: yes
    description: Number of observations to average over
  - 
    name: grace_period
    required: yes
    description: >
        Don't do anything unless you have at least this many observations


